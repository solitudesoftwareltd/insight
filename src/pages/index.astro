---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import IntroSection from "../components/sections/IntroSection.astro";
import CarouselSection from "../components/sections/CarouselSection.astro";
import CareersSection from "../components/sections/CareersSection.astro";
import WhySection from "../components/sections/WhySection.astro";
import TestimonialsSection from "../components/sections/TestimonialsSection.astro";
import AboutSection from "../components/sections/AboutSection.astro";
import Form from "../components/Form.astro";
import { getEntry } from "astro:content";

const home = await getEntry("pages", "home");
if (!home) throw new Error("Missing content: src/content/pages/home.md");

const { hero, sections } = home.data;
const cover = hero?.cover ? `${hero.cover}` : null;
---

<Layout>
  <Hero heading={hero.heading} cover={cover} />
  {
    sections.map((section) => {
      switch (section.type) {
        case "intro":
          return <IntroSection {...section} />;
        case "carousel":
          return <CarouselSection {...section} />;
        case "careers":
          return <CareersSection {...section} />;
        case "why":
          return <WhySection {...section} />;
        case "testimonials":
          return <TestimonialsSection {...section} />;
        case "about":
          return <AboutSection {...section} />;
        default:
          return null;
      }
    })
  }
  <Form />
</Layout>
